"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[817],{3905:(e,t,n)=>{n.d(t,{Zo:()=>h,kt:()=>u});var i=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=i.createContext({}),c=function(e){var t=i.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},h=function(e){var t=c(e.components);return i.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},d=i.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,h=l(e,["components","mdxType","originalType","parentName"]),d=c(n),u=r,m=d["".concat(s,".").concat(u)]||d[u]||p[u]||o;return n?i.createElement(m,a(a({ref:t},h),{},{components:n})):i.createElement(m,a({ref:t},h))}));function u(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,a=new Array(o);a[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,a[1]=l;for(var c=2;c<o;c++)a[c]=n[c];return i.createElement.apply(null,a)}return i.createElement.apply(null,n)}d.displayName="MDXCreateElement"},2726:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>a,default:()=>p,frontMatter:()=>o,metadata:()=>l,toc:()=>c});var i=n(3117),r=(n(7294),n(3905));const o={sidebar_position:5,title:"Live Preview"},a=void 0,l={unversionedId:"general/reference/live-preview",id:"general/reference/live-preview",title:"Live Preview",description:"The Live Preview feature allows admin users to see the voting booth before",source:"@site/docs/general/reference/live-preview.md",sourceDirName:"general/reference",slug:"/general/reference/live-preview",permalink:"/documentation/docs/general/reference/live-preview",draft:!1,editUrl:"https://github.com/sequentech/documentation/edit/master/docs/general/reference/live-preview.md",tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5,title:"Live Preview"},sidebar:"generalSidebar",previous:{title:"Cryptographic Protocol Overview",permalink:"/documentation/docs/general/reference/crypto-protocol/"},next:{title:"Contribute",permalink:"/documentation/docs/general/contribute/"}},s={},c=[{value:"URL",id:"url",level:2},{value:"URL with query params",id:"url-with-query-params",level:2},{value:"Parent and Children Elections",id:"parent-and-children-elections",level:2}],h={toc:c};function p(e){let{components:t,...o}=e;return(0,r.kt)("wrapper",(0,i.Z)({},h,o,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"The Live Preview feature allows admin users to see the voting booth before\ncreating the election, reducing the feedback loop. Here you'll learn how\nto access the Live Preview and how it works."),(0,r.kt)("p",null,"You can access the  Live Preview while creating the election in the admin\nconsole. Go to the last step of creating the election by clicking the\n",(0,r.kt)("inlineCode",{parentName:"p"},"Create Election")," sidebar. Then click the the ",(0,r.kt)("inlineCode",{parentName:"p"},"Actions")," button at the right\ntop, and then click on ",(0,r.kt)("inlineCode",{parentName:"p"},"Live Preview")," from the dropdown menu. This will\nopen the Live Preview in a new tab."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Live preview menu",src:n(3947).Z,width:"2642",height:"1238"})),(0,r.kt)("p",null,"Note that the voting booth shows a popup message and a top banner warning\nthat the vote will not be cast, as this is only a preview and the election\nhasn't been created and the voting period hasn't started yet."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Live preview voting booth",src:n(5337).Z,width:"2642",height:"1502"})),(0,r.kt)("h2",{id:"url"},"URL"),(0,r.kt)("p",null,"The way the live preview works is that instead of making API calls to retrieve\nthe election information, the information is passed from the admin console to\nthe voting booth by storing it in the session storage."),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"Live Preview")," URL has the following format:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"https://sequentech.io/booth/[election-id]/preview-vote\n")),(0,r.kt)("p",null,"When the voting booth is opened at that url, it retrieves the information on\nthe election in the session storage for the key ",(0,r.kt)("inlineCode",{parentName:"p"},"[election-id]"),". For example,\nif the election id is ",(0,r.kt)("inlineCode",{parentName:"p"},"123456789"),", then the election information will be retrieved\nwith this call:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"sessionStorage.getItem(123456789)\n")),(0,r.kt)("p",null,"The format of the election data is the same as the\n",(0,r.kt)("a",{parentName:"p",href:"../reference/election-creation-json"},"Election Creation JSON"),", it's just\na stringified version of that (using ",(0,r.kt)("inlineCode",{parentName:"p"},"JSON.stringify(data)"),"), as session storage\ncan only store strings."),(0,r.kt)("p",null,"The Election Creation JSON only needs to include the id of the election for\nParent-Children elections. In the rest of the cases the JSON will not need the\nelection ID. In those cases, the ID of the election for the URL is assumed to\nbe the default value ",(0,r.kt)("inlineCode",{parentName:"p"},"123456789"),"."),(0,r.kt)("h2",{id:"url-with-query-params"},"URL with query params"),(0,r.kt)("p",null,"Another way of passing the election data to the voting booth is through\nquery parameters. This means the HTTP Header will include the election data.\nAs different commonly used technologies limit the HTTP Header size, this is not\nthe default method the system uses for the Live Preview. However we discuss\nhow to get around these problems below."),(0,r.kt)("p",null,"In this case, the URL with the query params is:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"https://sequentech.io/booth/[election-id]/preview-vote?preview-election=[election-data]\n")),(0,r.kt)("p",null,"The election data is the ",(0,r.kt)("a",{parentName:"p",href:"../reference/election-creation-json"},"Election Creation JSON"),".\nIn this case it's not only stringified but also URL encoded. Specifically, if the json\nis in the ",(0,r.kt)("inlineCode",{parentName:"p"},"json")," variable, the query parameter ",(0,r.kt)("inlineCode",{parentName:"p"},"[election-data]")," will be generated with:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"encodeURIComponent(JSON.stringify(json))\n")),(0,r.kt)("p",null,"The system uses Nginx, and it limits the HTTP headers to 8k bytes by default.\nTo increase this limit, there's a deployment configuration variable at\n",(0,r.kt)("inlineCode",{parentName:"p"},"config.http.client_max_header_size"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"client_max_header_size: 256k\n")),(0,r.kt)("p",null,"Another technology that limits the HTTP Headers is Cloudflare. Cloudflare limits\nthe HTTP Headers to 32 KB, and the URL size to 16 KB. If you need to use the\nquery params method for Live Preview you probably can't use Cloudflare for the\nvoting booth."),(0,r.kt)("h2",{id:"parent-and-children-elections"},"Parent and Children Elections"),(0,r.kt)("p",null,"The Live Preview feature supports\n",(0,r.kt)("a",{parentName:"p",href:"../guides/parent-and-children-elections/"},"Parent and Children Elections"),"\nas well, where the parent election is the ",(0,r.kt)("inlineCode",{parentName:"p"},"[election-id]")," in the URL."),(0,r.kt)("p",null,"If the election is a Parent-Children election and the ids of the elections are\nmissing, the admin console will show the error at the bottom, and the\nLive Preview option will not be available:"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Live preview error",src:n(6749).Z,width:"2644",height:"1502"})))}p.isMDXComponent=!0},3947:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/create-election-live-preview-action-13902b6b8a62603c80a993381f8cb408.png"},6749:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/create-election-live-preview-error-13ebe0597f0b67e308c4532560dab1b0.png"},5337:(e,t,n)=>{n.d(t,{Z:()=>i});const i=n.p+"assets/images/live-preview-booth-09c827e4dc6d5958c32b37aa9e7d964a.png"}}]);